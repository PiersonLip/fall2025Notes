%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Define Article %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{article}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Using Packages %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{empheq}
\usepackage{mdframed}
\usepackage{booktabs}
\usepackage{lipsum}
\usepackage{graphicx}
\usepackage{color}
\usepackage{psfrag}
\usepackage{pgfplots}
\usepackage{bm}
\usepackage{amsmath}
\usepackage[most]{tcolorbox}
\usepackage{xparse}
\usepackage{hyperref}
\usetikzlibrary{calc,decorations.pathreplacing, arrows.meta, positioning, external}
\tikzexternalize[prefix=tikz-cache/]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Other Settings

%%%%%%%%%%%%%%%%%%%%%%%%%% Page Setting %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\geometry{a4paper}

%%%%%%%%%%%%%%%%%%%%%%%%%% Define some useful colors %%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{ocre}{RGB}{243,102,25}
\definecolor{mygray}{RGB}{243,243,244}
\definecolor{deepGreen}{RGB}{26,111,0}
\definecolor{shallowGreen}{RGB}{235,255,255}
\definecolor{deepBlue}{RGB}{61,124,222}
\definecolor{shallowBlue}{RGB}{235,249,255}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%% Define an orangebox command %%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\orangebox[1]{\fcolorbox{ocre}{mygray}{\hspace{1em}#1\hspace{1em}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%% English Environments %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheoremstyle{mytheoremstyle}{3pt}{3pt}{\normalfont}{0cm}{\rmfamily\bfseries}{}{1em}{{\color{black}\thmname{#1}~\thmnumber{#2}}\thmnote{\,--\,#3}}
\newtheoremstyle{myproblemstyle}{3pt}{3pt}{\normalfont}{0cm}{\rmfamily\bfseries}{}{1em}{{\color{black}\thmname{#1}~\thmnumber{#2}}\thmnote{\,--\,#3}}
\theoremstyle{mytheoremstyle}
\newmdtheoremenv[linewidth=1pt,backgroundcolor=shallowGreen,linecolor=deepGreen,leftmargin=0pt,innerleftmargin=20pt,innerrightmargin=20pt,]{theorem}{Theorem}[section]
\theoremstyle{mytheoremstyle}
\newmdtheoremenv[linewidth=1pt,backgroundcolor=shallowBlue,linecolor=deepBlue,leftmargin=0pt,innerleftmargin=20pt,innerrightmargin=20pt,]{definition}{Definition}[section]
\theoremstyle{myproblemstyle}
\newmdtheoremenv[linecolor=black,leftmargin=0pt,innerleftmargin=10pt,innerrightmargin=10pt,]{problem}{Problem}[section]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Plotting Settings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepgfplotslibrary{colorbrewer}
\pgfplotsset{width=8cm,compat=1.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Title & Author %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Title}
\author{Haoyun Qin}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\usepackage{amsmath}
\usepackage[most]{tcolorbox}
\usepackage{xparse}

\tcbset{
  eqboxstyle/.style={
    colback=black!2,
    colframe=black!70,
    boxrule=0.5pt,
    sharp corners,
    left=6pt,right=6pt,top=4pt,bottom=4pt,
  }
}

\ExplSyntaxOn
\seq_new:N \g_piers_eq_seq

% Store (label, title, equation-body) for later printing
\cs_new_protected:Npn \piers_add_eq:nnn #1#2#3
  {
    \seq_gput_right:Nn \g_piers_eq_seq
      { \piers_eq_entry:nnn {#1}{#2}{#3} }
  }

% How each equation is printed in the final summary
\cs_new_protected:Npn \piers_eq_entry:nnn #1#2#3
  {
    \par\noindent
    \begin{minipage}{0.72\linewidth}
      \begin{equation*}
        #3
      \end{equation*}
    \end{minipage}
    \begin{minipage}{0.9\linewidth}
      \raggedright
      \qquad\eqref{#1}\;(\textit{#2})
    \end{minipage}

    \par\bigskip
  }

% Environment: \begin{eqboxed}{label}{Title}{Description} <equation> \end{eqboxed}
\NewDocumentEnvironment{eqboxed}{ m m m +b }
  {
    % begin code
    \begin{tcolorbox}[eqboxstyle,title={#2}]
      \begin{equation}
        \label{#1}
        #4
      \end{equation}
      #3
    \end{tcolorbox}
    % store equation body for later
    \piers_add_eq:nnn{#1}{#2}{#4}
  }
  {
    % end code (nothing extra needed here)
  }

% Command to print all stored equations at the end
\NewDocumentCommand{\PrintAllEquations}{}
  {
    \section*{Summary of Equations}
    \seq_use:Nn \g_piers_eq_seq { }
  }
\ExplSyntaxOff



\begin{document}
    \maketitle
    


\begin{eqboxed}{eq:escape-velocity}{Escape Velocity}
  {The minimum speed needed for an object to escape a body's gravitational field without further propulsion.}
  v_{\mathrm{esc}} = \sqrt{\frac{2GM}{R}}
\end{eqboxed}


\begin{eqboxed}{eq:test-eq}{testttt31}
  {The minimum speed needed for an object to escape a body's gravitational field without further propulsion.}
  v_{\mathrm{esc}} = \sqrt{\frac{2GM}{R}}
\end{eqboxed}
\PrintAllEquations


\begin{tikzpicture}
\begin{axis}[
legend pos=outer north east,
title=Example,
axis lines = box,
colormap/hot,
xlabel = $x$,
ylabel = $y$,
zlabel = $z$,
variable = t,
trig format plots = rad,
]

\addplot3[
    surf,
    samples=50,
]
{x^2+y^2};
\addlegendentry{$x$}

\end{axis}
\end{tikzpicture}


\end{document}